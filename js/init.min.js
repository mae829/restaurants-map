function MarkerClusterer(e,t,r){this.extend(MarkerClusterer,google.maps.OverlayView),this.map_=e,this.markers_=[],this.clusters_=[],this.sizes=[53,56,66,78,90],this.styles_=[],this.ready_=!1;var s=r||{};this.gridSize_=s.gridSize||60,this.minClusterSize_=s.minimumClusterSize||2,this.maxZoom_=s.maxZoom||null,this.styles_=s.styles||[],this.imagePath_=s.imagePath||this.MARKER_CLUSTER_IMAGE_PATH_,this.imageExtension_=s.imageExtension||this.MARKER_CLUSTER_IMAGE_EXTENSION_,this.zoomOnClick_=!0,void 0!=s.zoomOnClick&&(this.zoomOnClick_=s.zoomOnClick),this.averageCenter_=!1,void 0!=s.averageCenter&&(this.averageCenter_=s.averageCenter),this.setupStyles_(),this.setMap(e),this.prevZoom_=this.map_.getZoom();var i=this;google.maps.event.addListener(this.map_,"zoom_changed",function(){var e=i.map_.getZoom(),t=i.map_.minZoom||0,r=Math.min(i.map_.maxZoom||100,i.map_.mapTypes[i.map_.getMapTypeId()].maxZoom);e=Math.min(Math.max(e,t),r),i.prevZoom_!=e&&(i.prevZoom_=e,i.resetViewport())}),google.maps.event.addListener(this.map_,"idle",function(){i.redraw()}),t&&(t.length||Object.keys(t).length)&&this.addMarkers(t,!1)}function Cluster(e){this.markerClusterer_=e,this.map_=e.getMap(),this.gridSize_=e.getGridSize(),this.minClusterSize_=e.getMinClusterSize(),this.averageCenter_=e.isAverageCenter(),this.center_=null,this.markers_=[],this.bounds_=null,this.clusterIcon_=new ClusterIcon(this,e.getStyles(),e.getGridSize())}function ClusterIcon(e,t,r){e.getMarkerClusterer().extend(ClusterIcon,google.maps.OverlayView),this.styles_=t,this.padding_=r||0,this.cluster_=e,this.center_=null,this.map_=e.getMap(),this.div_=null,this.sums_=null,this.visible_=!1,this.setMap(this.map_)}!function(){"use strict";var e="undefined"!=typeof process&&!process.browser,t=function(){throw new Error("The 'request' module is only available while running in Node.")};e&&(t=require("request"));var r=!1,s=!1;try{void 0!==(new XMLHttpRequest).withCredentials?r=!0:"XDomainRequest"in window&&(r=!0,s=!0)}catch(e){}var o=Array.prototype.indexOf,n=function(e,t){var r=0,s=e.length;if(o&&e.indexOf===o)return e.indexOf(t);for(;r<s;r++)if(e[r]===t)return r;return-1},a=function(t){if(!(this&&this instanceof a))return new a(t);"string"==typeof t&&(t={key:t}),this.callback=t.callback,this.wanted=t.wanted||[],this.key=t.key,this.simpleSheet=!!t.simpleSheet,this.parseNumbers=!!t.parseNumbers,this.wait=!!t.wait,this.reverse=!!t.reverse,this.postProcess=t.postProcess,this.debug=!!t.debug,this.query=t.query||"",this.orderby=t.orderby,this.endpoint=t.endpoint||"https://spreadsheets.google.com",this.singleton=!!t.singleton,this.simpleUrl=!(!t.simpleUrl&&!t.simple_url),this.authkey=t.authkey,this.sheetPrivacy=this.authkey?"private":"public",this.callbackContext=t.callbackContext,this.prettyColumnNames=void 0===t.prettyColumnNames?!t.proxy:t.prettyColumnNames,void 0!==t.proxy&&(this.endpoint=t.proxy.replace(/\/$/,""),this.simpleUrl=!0,this.singleton=!0,r=!1),this.parameterize=t.parameterize||!1,this.singleton&&(void 0!==a.singleton&&this.log("WARNING! Tabletop singleton already defined"),a.singleton=this),/key=/.test(this.key)&&(this.log("You passed an old Google Docs url as the key! Attempting to parse."),this.key=this.key.match("key=(.*?)(&|#|$)")[1]),/pubhtml/.test(this.key)&&(this.log("You passed a new Google Spreadsheets url as the key! Attempting to parse."),this.key=this.key.match("d\\/(.*?)\\/pubhtml")[1]),/spreadsheets\/d/.test(this.key)&&(this.log("You passed the most recent version of Google Spreadsheets url as the key! Attempting to parse."),this.key=this.key.match("d\\/(.*?)/")[1]),this.key?(this.log("Initializing with key "+this.key),this.models={},this.modelNames=[],this.model_names=this.modelNames,this.baseJsonPath="/feeds/worksheets/"+this.key+"/"+this.sheetPrivacy+"/basic?alt=",this.baseJsonPath+=e||r?"json":"json-in-script",this.wait||this.fetch()):this.log("You need to pass Tabletop a key!")};a.callbacks={},a.init=function(e){return new a(e)},a.sheets=function(){this.log("Times have changed! You'll want to use var tabletop = Tabletop.init(...); tabletop.sheets(...); instead of Tabletop.sheets(...)")},a.prototype={fetch:function(e){void 0!==e&&(this.callback=e),this.requestData(this.baseJsonPath,this.loadSheets)},requestData:function(t,i){if(this.log("Requesting",t),e)this.serverSideFetch(t,i);else{var o=this.endpoint.split("//").shift()||"http";!r||s&&o!==location.protocol?this.injectScript(t,i):this.xhrFetch(t,i)}},xhrFetch:function(e,t){var r=s?new XDomainRequest:new XMLHttpRequest;r.open("GET",this.endpoint+e);var i=this;r.onload=function(){var e;try{e=JSON.parse(r.responseText)}catch(e){console.error(e)}t.call(i,e)},r.send()},injectScript:function(e,t){var r,s=document.createElement("script");if(this.singleton)t===this.loadSheets?r="Tabletop.singleton.loadSheets":t===this.loadSheet&&(r="Tabletop.singleton.loadSheet");else{var i=this;r="tt"+ +new Date+Math.floor(1e5*Math.random()),a.callbacks[r]=function(){var e=Array.prototype.slice.call(arguments,0);t.apply(i,e),s.parentNode.removeChild(s),delete a.callbacks[r]},r="Tabletop.callbacks."+r}var o=e+"&callback="+r;this.simpleUrl?-1!==e.indexOf("/list/")?s.src=this.endpoint+"/"+this.key+"-"+e.split("/")[4]:s.src=this.endpoint+"/"+this.key:s.src=this.endpoint+o,this.parameterize&&(s.src=this.parameterize+encodeURIComponent(s.src)),this.log("Injecting",s.src),document.getElementsByTagName("script")[0].parentNode.appendChild(s)},serverSideFetch:function(e,r){var s=this;this.log("Fetching",this.endpoint+e),t({url:this.endpoint+e,json:!0},function(e,t,i){if(e)return console.error(e);r.call(s,i)})},isWanted:function(e){return 0===this.wanted.length||-1!==n(this.wanted,e)},data:function(){if(0!==this.modelNames.length)return this.simpleSheet?(this.modelNames.length>1&&this.debug&&this.log("WARNING You have more than one sheet but are using simple sheet mode! Don't blame me when something goes wrong."),this.models[this.modelNames[0]].all()):this.models},addWanted:function(e){-1===n(this.wanted,e)&&this.wanted.push(e)},loadSheets:function(t){var s,i,o=[];for(this.googleSheetName=t.feed.title.$t,this.foundSheetNames=[],s=0,i=t.feed.entry.length;s<i;s++)if(this.foundSheetNames.push(t.feed.entry[s].title.$t),this.isWanted(t.feed.entry[s].content.$t)){var n=t.feed.entry[s].link.length-1,a=t.feed.entry[s].link[n].href.split("/").pop(),l="/feeds/list/"+this.key+"/"+a+"/"+this.sheetPrivacy+"/values?alt=";l+=e||r?"json":"json-in-script",this.query&&(l+="&tq="+this.query),this.orderby&&(l+="&orderby=column:"+this.orderby.toLowerCase()),this.reverse&&(l+="&reverse=true"),o.push(l)}for(this.sheetsToLoad=o.length,s=0,i=o.length;s<i;s++)this.requestData(o[s],this.loadSheet)},sheets:function(e){return void 0===e?this.models:void 0===this.models[e]?void 0:this.models[e]},sheetReady:function(e){this.models[e.name]=e,-1===n(this.modelNames,e.name)&&this.modelNames.push(e.name),this.sheetsToLoad--,0===this.sheetsToLoad&&this.doCallback()},loadSheet:function(e){var t=this;new a.Model({data:e,parseNumbers:this.parseNumbers,postProcess:this.postProcess,tabletop:this,prettyColumnNames:this.prettyColumnNames,onReady:function(){t.sheetReady(this)}})},doCallback:function(){0===this.sheetsToLoad&&this.callback.apply(this.callbackContext||this,[this.data(),this])},log:function(){this.debug&&"undefined"!=typeof console&&void 0!==console.log&&Function.prototype.apply.apply(console.log,[console,arguments])}},a.Model=function(e){var t,r,s,i;if(this.columnNames=[],this.column_names=this.columnNames,this.name=e.data.feed.title.$t,this.tabletop=e.tabletop,this.elements=[],this.onReady=e.onReady,this.raw=e.data,void 0===e.data.feed.entry)return e.tabletop.log("Missing data for "+this.name+", make sure you didn't forget column headers"),this.originalColumns=[],this.elements=[],void this.ready();for(var o in e.data.feed.entry[0])/^gsx/.test(o)&&this.columnNames.push(o.replace("gsx$",""));for(this.originalColumns=this.columnNames,this.original_columns=this.originalColumns,t=0,s=e.data.feed.entry.length;t<s;t++){var n=e.data.feed.entry[t],a={};for(r=0,i=this.columnNames.length;r<i;r++){var l=n["gsx$"+this.columnNames[r]];void 0!==l?e.parseNumbers&&""!==l.$t&&!isNaN(l.$t)?a[this.columnNames[r]]=+l.$t:a[this.columnNames[r]]=l.$t:a[this.columnNames[r]]=""}void 0===a.rowNumber&&(a.rowNumber=t+1),this.elements.push(a)}e.prettyColumnNames?this.fetchPrettyColumns():this.ready()},a.Model.prototype={all:function(){return this.elements},fetchPrettyColumns:function(){if(!this.raw.feed.link[3])return this.ready();var e=this.raw.feed.link[3].href.replace("/feeds/list/","/feeds/cells/").replace("https://spreadsheets.google.com",""),t=this;this.tabletop.requestData(e,function(e){t.loadPrettyColumns(e)})},beforeReady:function(){if(this.postProcess)for(i=0,ilen=this.elements.length;i<ilen;i++)this.postProcess(element)},ready:function(){this.beforeReady(),this.onReady.call(this)},loadPrettyColumns:function(e){for(var t={},r=this.columnNames,s=0,i=r.length;s<i;s++)void 0!==e.feed.entry[s].content.$t?t[r[s]]=e.feed.entry[s].content.$t:t[r[s]]=r[s];this.prettyColumns=t,this.pretty_columns=this.prettyColumns,this.prettifyElements(),this.ready()},prettifyElements:function(){var e,t,r,s,i=[],o=[];for(t=0,s=this.columnNames.length;t<s;t++)o.push(this.prettyColumns[this.columnNames[t]]);for(e=0,r=this.elements.length;e<r;e++){var n={};for(t=0,s=this.columnNames.length;t<s;t++)n[this.prettyColumns[this.columnNames[t]]]=this.elements[e][this.columnNames[t]];i.push(n)}this.elements=i,this.columnNames=o},toArray:function(){var e,t,r,s,i=[];for(e=0,r=this.elements.length;e<r;e++){var o=[];for(t=0,s=this.columnNames.length;t<s;t++)o.push(this.elements[e][this.columnNames[t]]);i.push(o)}return i}},"undefined"!=typeof module&&module.exports?module.exports=a:"function"==typeof define&&define.amd?define(function(){return a}):window.Tabletop=a}(),MarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_PATH_="../images/m",MarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_EXTENSION_="png",MarkerClusterer.prototype.extend=function(e,t){return function(e){for(var t in e.prototype)this.prototype[t]=e.prototype[t];return this}.apply(e,[t])},MarkerClusterer.prototype.onAdd=function(){this.setReady_(!0)},MarkerClusterer.prototype.draw=function(){},MarkerClusterer.prototype.setupStyles_=function(){if(!this.styles_.length)for(var e,t=0;e=this.sizes[t];t++)this.styles_.push({url:this.imagePath_+(t+1)+"."+this.imageExtension_,height:e,width:e})},MarkerClusterer.prototype.fitMapToMarkers=function(){for(var e,t=this.getMarkers(),r=new google.maps.LatLngBounds,s=0;e=t[s];s++)r.extend(e.getPosition());this.map_.fitBounds(r)},MarkerClusterer.prototype.setStyles=function(e){this.styles_=e},MarkerClusterer.prototype.getStyles=function(){return this.styles_},MarkerClusterer.prototype.isZoomOnClick=function(){return this.zoomOnClick_},MarkerClusterer.prototype.isAverageCenter=function(){return this.averageCenter_},MarkerClusterer.prototype.getMarkers=function(){return this.markers_},MarkerClusterer.prototype.getTotalMarkers=function(){return this.markers_.length},MarkerClusterer.prototype.setMaxZoom=function(e){this.maxZoom_=e},MarkerClusterer.prototype.getMaxZoom=function(){return this.maxZoom_},MarkerClusterer.prototype.calculator_=function(e,t){for(var r=0,s=e.length,i=s;0!==i;)i=parseInt(i/10,10),r++;return r=Math.min(r,t),{text:s,index:r}},MarkerClusterer.prototype.setCalculator=function(e){this.calculator_=e},MarkerClusterer.prototype.getCalculator=function(){return this.calculator_},MarkerClusterer.prototype.addMarkers=function(e,t){if(e.length)for(var r=0;s=e[r];r++)this.pushMarkerTo_(s);else if(Object.keys(e).length)for(var s in e)this.pushMarkerTo_(e[s]);t||this.redraw()},MarkerClusterer.prototype.pushMarkerTo_=function(e){if(e.isAdded=!1,e.draggable){var t=this;google.maps.event.addListener(e,"dragend",function(){e.isAdded=!1,t.repaint()})}this.markers_.push(e)},MarkerClusterer.prototype.addMarker=function(e,t){this.pushMarkerTo_(e),t||this.redraw()},MarkerClusterer.prototype.removeMarker_=function(e){var t=-1;if(this.markers_.indexOf)t=this.markers_.indexOf(e);else for(var r,s=0;r=this.markers_[s];s++)if(r==e){t=s;break}return-1!=t&&(e.setMap(null),this.markers_.splice(t,1),!0)},MarkerClusterer.prototype.removeMarker=function(e,t){var r=this.removeMarker_(e);return!(t||!r)&&(this.resetViewport(),this.redraw(),!0)},MarkerClusterer.prototype.removeMarkers=function(e,t){for(var r,s=e===this.getMarkers()?e.slice():e,i=!1,o=0;r=s[o];o++){var n=this.removeMarker_(r);i=i||n}if(!t&&i)return this.resetViewport(),this.redraw(),!0},MarkerClusterer.prototype.setReady_=function(e){this.ready_||(this.ready_=e,this.createClusters_())},MarkerClusterer.prototype.getTotalClusters=function(){return this.clusters_.length},MarkerClusterer.prototype.getMap=function(){return this.map_},MarkerClusterer.prototype.setMap=function(e){this.map_=e},MarkerClusterer.prototype.getGridSize=function(){return this.gridSize_},MarkerClusterer.prototype.setGridSize=function(e){this.gridSize_=e},MarkerClusterer.prototype.getMinClusterSize=function(){return this.minClusterSize_},MarkerClusterer.prototype.setMinClusterSize=function(e){this.minClusterSize_=e},MarkerClusterer.prototype.getExtendedBounds=function(e){var t=this.getProjection(),r=new google.maps.LatLng(e.getNorthEast().lat(),e.getNorthEast().lng()),s=new google.maps.LatLng(e.getSouthWest().lat(),e.getSouthWest().lng()),i=t.fromLatLngToDivPixel(r);i.x+=this.gridSize_,i.y-=this.gridSize_;var o=t.fromLatLngToDivPixel(s);o.x-=this.gridSize_,o.y+=this.gridSize_;var n=t.fromDivPixelToLatLng(i),a=t.fromDivPixelToLatLng(o);return e.extend(n),e.extend(a),e},MarkerClusterer.prototype.isMarkerInBounds_=function(e,t){return t.contains(e.getPosition())},MarkerClusterer.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers_=[]},MarkerClusterer.prototype.resetViewport=function(e){for(var t,r=0;t=this.clusters_[r];r++)t.remove();for(var s,r=0;s=this.markers_[r];r++)s.isAdded=!1,e&&s.setMap(null);this.clusters_=[]},MarkerClusterer.prototype.repaint=function(){var e=this.clusters_.slice();this.clusters_.length=0,this.resetViewport(),this.redraw(),window.setTimeout(function(){for(var t,r=0;t=e[r];r++)t.remove()},0)},MarkerClusterer.prototype.redraw=function(){this.createClusters_()},MarkerClusterer.prototype.distanceBetweenPoints_=function(e,t){if(!e||!t)return 0;var r=(t.lat()-e.lat())*Math.PI/180,s=(t.lng()-e.lng())*Math.PI/180,i=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e.lat()*Math.PI/180)*Math.cos(t.lat()*Math.PI/180)*Math.sin(s/2)*Math.sin(s/2);return 6371*(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)))},MarkerClusterer.prototype.addToClosestCluster_=function(e){for(var t,r=4e4,s=null,i=(e.getPosition(),0);t=this.clusters_[i];i++){var o=t.getCenter();if(o){var n=this.distanceBetweenPoints_(o,e.getPosition());n<r&&(r=n,s=t)}}s&&s.isMarkerInClusterBounds(e)?s.addMarker(e):((t=new Cluster(this)).addMarker(e),this.clusters_.push(t))},MarkerClusterer.prototype.createClusters_=function(){if(this.ready_)for(var e,t=new google.maps.LatLngBounds(this.map_.getBounds().getSouthWest(),this.map_.getBounds().getNorthEast()),r=this.getExtendedBounds(t),s=0;e=this.markers_[s];s++)!e.isAdded&&this.isMarkerInBounds_(e,r)&&this.addToClosestCluster_(e)},Cluster.prototype.isMarkerAlreadyAdded=function(e){if(this.markers_.indexOf)return-1!=this.markers_.indexOf(e);for(var t,r=0;t=this.markers_[r];r++)if(t==e)return!0;return!1},Cluster.prototype.addMarker=function(e){if(this.isMarkerAlreadyAdded(e))return!1;if(this.center_){if(this.averageCenter_){var t=this.markers_.length+1,r=(this.center_.lat()*(t-1)+e.getPosition().lat())/t,s=(this.center_.lng()*(t-1)+e.getPosition().lng())/t;this.center_=new google.maps.LatLng(r,s),this.calculateBounds_()}}else this.center_=e.getPosition(),this.calculateBounds_();e.isAdded=!0,this.markers_.push(e);var i=this.markers_.length;if(i<this.minClusterSize_&&e.getMap()!=this.map_&&e.setMap(this.map_),i==this.minClusterSize_)for(var o=0;o<i;o++)this.markers_[o].setMap(null);return i>=this.minClusterSize_&&e.setMap(null),this.updateIcon(),!0},Cluster.prototype.getMarkerClusterer=function(){return this.markerClusterer_},Cluster.prototype.getBounds=function(){for(var e,t=new google.maps.LatLngBounds(this.center_,this.center_),r=this.getMarkers(),s=0;e=r[s];s++)t.extend(e.getPosition());return t},Cluster.prototype.remove=function(){this.clusterIcon_.remove(),this.markers_.length=0,delete this.markers_},Cluster.prototype.getSize=function(){return this.markers_.length},Cluster.prototype.getMarkers=function(){return this.markers_},Cluster.prototype.getCenter=function(){return this.center_},Cluster.prototype.calculateBounds_=function(){var e=new google.maps.LatLngBounds(this.center_,this.center_);this.bounds_=this.markerClusterer_.getExtendedBounds(e)},Cluster.prototype.isMarkerInClusterBounds=function(e){return this.bounds_.contains(e.getPosition())},Cluster.prototype.getMap=function(){return this.map_},Cluster.prototype.updateIcon=function(){var e=this.map_.getZoom(),t=this.markerClusterer_.getMaxZoom();if(t&&e>t)for(var r,s=0;r=this.markers_[s];s++)r.setMap(this.map_);else if(this.markers_.length<this.minClusterSize_)this.clusterIcon_.hide();else{var i=this.markerClusterer_.getStyles().length,o=this.markerClusterer_.getCalculator()(this.markers_,i);this.clusterIcon_.setCenter(this.center_),this.clusterIcon_.setSums(o),this.clusterIcon_.show()}},ClusterIcon.prototype.triggerClusterClick=function(){var e=this.cluster_.getMarkerClusterer();google.maps.event.trigger(e,"clusterclick",this.cluster_),e.isZoomOnClick()&&this.map_.fitBounds(this.cluster_.getBounds())},ClusterIcon.prototype.onAdd=function(){if(this.div_=document.createElement("DIV"),this.visible_){var e=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(e),this.div_.innerHTML=this.sums_.text}this.getPanes().overlayMouseTarget.appendChild(this.div_);var t=this;google.maps.event.addDomListener(this.div_,"click",function(){t.triggerClusterClick()})},ClusterIcon.prototype.getPosFromLatLng_=function(e){var t=this.getProjection().fromLatLngToDivPixel(e);return t.x-=parseInt(this.width_/2,10),t.y-=parseInt(this.height_/2,10),t},ClusterIcon.prototype.draw=function(){if(this.visible_){var e=this.getPosFromLatLng_(this.center_);this.div_.style.top=e.y+"px",this.div_.style.left=e.x+"px"}},ClusterIcon.prototype.hide=function(){this.div_&&(this.div_.style.display="none"),this.visible_=!1},ClusterIcon.prototype.show=function(){if(this.div_){var e=this.getPosFromLatLng_(this.center_);this.div_.style.cssText=this.createCss(e),this.div_.style.display=""}this.visible_=!0},ClusterIcon.prototype.remove=function(){this.setMap(null)},ClusterIcon.prototype.onRemove=function(){this.div_&&this.div_.parentNode&&(this.hide(),this.div_.parentNode.removeChild(this.div_),this.div_=null)},ClusterIcon.prototype.setSums=function(e){this.sums_=e,this.text_=e.text,this.index_=e.index,this.div_&&(this.div_.innerHTML=e.text),this.useStyle()},ClusterIcon.prototype.useStyle=function(){var e=Math.max(0,this.sums_.index-1);e=Math.min(this.styles_.length-1,e);var t=this.styles_[e];this.url_=t.url,this.height_=t.height,this.width_=t.width,this.textColor_=t.textColor,this.anchor_=t.anchor,this.textSize_=t.textSize,this.backgroundPosition_=t.backgroundPosition},ClusterIcon.prototype.setCenter=function(e){this.center_=e},ClusterIcon.prototype.createCss=function(e){var t=[];t.push("background-image:url("+this.url_+");");var r=this.backgroundPosition_?this.backgroundPosition_:"0 0";t.push("background-position:"+r+";"),"object"==typeof this.anchor_?("number"==typeof this.anchor_[0]&&this.anchor_[0]>0&&this.anchor_[0]<this.height_?t.push("height:"+(this.height_-this.anchor_[0])+"px; padding-top:"+this.anchor_[0]+"px;"):t.push("height:"+this.height_+"px; line-height:"+this.height_+"px;"),"number"==typeof this.anchor_[1]&&this.anchor_[1]>0&&this.anchor_[1]<this.width_?t.push("width:"+(this.width_-this.anchor_[1])+"px; padding-left:"+this.anchor_[1]+"px;"):t.push("width:"+this.width_+"px; text-align:center;")):t.push("height:"+this.height_+"px; line-height:"+this.height_+"px; width:"+this.width_+"px; text-align:center;");var s=this.textColor_?this.textColor_:"black",i=this.textSize_?this.textSize_:11;return t.push("cursor:pointer; top:"+e.y+"px; left:"+e.x+"px; color:"+s+"; position:absolute; font-size:"+i+"px; font-family:Arial,sans-serif; font-weight:bold"),t.join("")},window.MarkerClusterer=MarkerClusterer,MarkerClusterer.prototype.addMarker=MarkerClusterer.prototype.addMarker,MarkerClusterer.prototype.addMarkers=MarkerClusterer.prototype.addMarkers,MarkerClusterer.prototype.clearMarkers=MarkerClusterer.prototype.clearMarkers,MarkerClusterer.prototype.fitMapToMarkers=MarkerClusterer.prototype.fitMapToMarkers,MarkerClusterer.prototype.getCalculator=MarkerClusterer.prototype.getCalculator,MarkerClusterer.prototype.getGridSize=MarkerClusterer.prototype.getGridSize,MarkerClusterer.prototype.getExtendedBounds=MarkerClusterer.prototype.getExtendedBounds,MarkerClusterer.prototype.getMap=MarkerClusterer.prototype.getMap,MarkerClusterer.prototype.getMarkers=MarkerClusterer.prototype.getMarkers,MarkerClusterer.prototype.getMaxZoom=MarkerClusterer.prototype.getMaxZoom,MarkerClusterer.prototype.getStyles=MarkerClusterer.prototype.getStyles,MarkerClusterer.prototype.getTotalClusters=MarkerClusterer.prototype.getTotalClusters,MarkerClusterer.prototype.getTotalMarkers=MarkerClusterer.prototype.getTotalMarkers,MarkerClusterer.prototype.redraw=MarkerClusterer.prototype.redraw,MarkerClusterer.prototype.removeMarker=MarkerClusterer.prototype.removeMarker,MarkerClusterer.prototype.removeMarkers=MarkerClusterer.prototype.removeMarkers,MarkerClusterer.prototype.resetViewport=MarkerClusterer.prototype.resetViewport,MarkerClusterer.prototype.repaint=MarkerClusterer.prototype.repaint,MarkerClusterer.prototype.setCalculator=MarkerClusterer.prototype.setCalculator,MarkerClusterer.prototype.setGridSize=MarkerClusterer.prototype.setGridSize,MarkerClusterer.prototype.setMaxZoom=MarkerClusterer.prototype.setMaxZoom,MarkerClusterer.prototype.onAdd=MarkerClusterer.prototype.onAdd,MarkerClusterer.prototype.draw=MarkerClusterer.prototype.draw,Cluster.prototype.getCenter=Cluster.prototype.getCenter,Cluster.prototype.getSize=Cluster.prototype.getSize,Cluster.prototype.getMarkers=Cluster.prototype.getMarkers,ClusterIcon.prototype.onAdd=ClusterIcon.prototype.onAdd,ClusterIcon.prototype.draw=ClusterIcon.prototype.draw,ClusterIcon.prototype.onRemove=ClusterIcon.prototype.onRemove,Object.keys=Object.keys||function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t},function(e){var t="https://docs.google.com/spreadsheets/d/1ubZ_8P7AlgdQQTeX9LXcl-tDelwWX4Ucag_078FFhb4/pubhtml";diningMap={map:{},bounds:null,geoLatLng:null,browserLoc:null,markers:[],clusterer:null,infoBox:null,clusterOptions:{gridSize:50,minimumClusterSize:5,enableRetinaIcons:!0,maxZoom:13,styles:[{url:"images/m1.png",width:53,height:52,textColor:"#fff"}]},mapStyle:{zoom:12,minZoom:10,center:new google.maps.LatLng(32.8007043,-117.12466109277342),mapTypeControl:!1,fullscreenControl:!1,rotateControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,streetViewControl:!1}},e(function(){function r(){Tabletop.init({key:t,callback:function(e,t){var r={};for(var o in e)r[o]=t.sheets(o).all();s(r),i(r)}})}function s(t){e.ajax({type:"POST",dataType:"json",data:{dataToSave:JSON.stringify(t)},url:"inc/savedata.php"})}function i(e){var t=Object.keys(e);t.length>1?o(t,e):n(e[t[0]])}function o(t,r){var s=e(".cities__overlay"),i=e(".cities__selection");for(var o in t)i.append(e("<option>",{value:t[o],text:t[o]}));s.fadeIn(),i.on("change",function(){var t=e(this).val();n(r[t]),s.fadeOut()})}function n(e){for(var t=0;t<e.length;t++){var r=e[t];if(""!=r.Latitude&&""!=r.Longitude&&""==r.Status){var s=new google.maps.LatLng(r.Latitude,r.Longitude),i=(r.Name,""!=r["Been?"]?"#1392db":"#ee1c24"),o=new google.maps.Marker({position:s,map:diningMap.map,title:r.Name,data:r,keyId:t,icon:d(i)});diningMap.bounds.extend(o.position),diningMap.markers.push(o),google.maps.event.addListener(o,"click",function(){l(this)}),google.maps.event.addListener(o,"mouseover",function(){u(),diningMap.infoBox.setContent(this.title),diningMap.infoBox.open(diningMap.map,this)}),google.maps.event.addListener(o,"mouseout",u)}}diningMap.clusterer.addMarkers(diningMap.markers),diningMap.map.fitBounds(diningMap.bounds),diningMap.map.setCenter(diningMap.bounds.getCenter())}function a(){var e=c.width(),t=m.hasClass("minimal");e<768&&!t?m.addClass("minimal"):e>=768&&t&&m.removeClass("minimal")}function l(t){var r=e(".location__details").html(""),s=""!=t.data.Website?t.data.Website:"";m.hasClass("minimal")&&g.addClass("open"),""!=s?e(".location__name").html('<a href="'+s+'" target="_blank" rel="noopener">'+t.title+"</a>"):e(".location__name").text(t.title);for(var i in t.data)switch(i){case"Been?":var o=""!=t.data[i]?"Yes":"No";$singleDetail=h(i,o),r.append($singleDetail);break;case"Instagram":break;case"Website":case"Latitude":case"Longitude":case"Name":break;default:""!=t.data[i]&&($singleDetail=h(i,t.data[i]),r.append($singleDetail))}""!=s&&($button=p("Website",t.data.Website),r.append($button))}function h(t,r){var s=t.toLowerCase().replace(/[^a-zA-Z0-9]+/g,""),i=e('<p class="location__'+s+'"></p>');return i.append('<span class="highlight">'+t+":</span> "+r),i}function p(t,r){var s=t.toLowerCase().replace(/[^a-zA-Z0-9]+/g,""),i=e('<a href="'+r+'" target="_blank" rel="noopener" class="button location__'+s+'"></a>');return i.text(t),i}function u(){diningMap.infoBox&&diningMap.infoBox.close()}function d(e){return{path:google.maps.SymbolPath.CIRCLE,fillColor:e,fillOpacity:1,strokeColor:"#000",strokeWeight:2,scale:10}}var c=e(window),m=e("body"),g=e(".sidebar"),y=c.height(),f=e(".map-canvas"),_=null;f.height(y),diningMap.map=new google.maps.Map(f[0],diningMap.mapStyle),diningMap.clusterer=new MarkerClusterer(diningMap.map,null,diningMap.clusterOptions),diningMap.bounds=new google.maps.LatLngBounds,diningMap.infoBox=new google.maps.InfoWindow,c.resize(function(){clearTimeout(_),_=setTimeout(function(){var e=c.height();c.width(),f.height(e),diningMap.map.setCenter(diningMap.mapStyle.center),a()},100)}),a(),e.ajax({url:"inc/sheetdata.json",success:function(e,t,s){var o=new Date,n=new Date(s.getResponseHeader("Last-Modified"));(o=o.getTime())>n.getTime()+18e6?r():i(e)},error:function(e){r()}}),e(".location__close").on("click",function(e){return e.preventDefault(),g.hasClass("open")&&g.removeClass("open"),!1})})}(jQuery);